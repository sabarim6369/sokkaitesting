{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/User/Documents/Projects/sokkai1/sokkai/clothing/src/app/frontend/signup/page.jsx"],"sourcesContent":["'use client';\r\nimport Image from 'next/image';\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport axios from 'axios';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport { initOTPless } from '@/app/utils/initOtpless';\r\nimport './signup.css';\r\n\r\nimport Modal from 'react-modal';\r\n\r\nconst Signup = () => {\r\n  const [backgroundIndex, setBackgroundIndex] = useState(0);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    firstName: '',\r\n    lastName: '',\r\n    email: '',\r\n    password: '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const router = useRouter();\r\n\r\n  const backgrounds = [\r\n    '/images/login/a4.jpg',\r\n    '/images/login/a3.jpg',\r\n    '/images/login/a6.webp',\r\n    '/images/login/a7.jpg',\r\n    '/images/login/a8.jpg',\r\n    '/images/login/a11.jpg',\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setBackgroundIndex((prevIndex) => (prevIndex + 1) % backgrounds.length);\r\n    }, 3000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prevData) => ({\r\n      ...prevData,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      const response = await axios.post('/api/Auth', formData);\r\n\r\n      const { token, user } = response.data;\r\nconsole.log(\"token provided is\",token,\"üëèüëèüëèüëèüëèüëèüëèüëèüëèüëèüòí‚ù§Ô∏è‚Äçüî•‚ù§Ô∏è‚Äçüî•‚ù§Ô∏è‚Äçüî•‚ù§Ô∏è‚Äçüî•‚ù§Ô∏è‚Äçüî•‚ù§Ô∏è‚Äçüî•‚ù§Ô∏è‚Äçüî•\")\r\n      localStorage.setItem('authToken', token);\r\n\r\n      toast.success('Account created successfully!')\r\n\r\n      setTimeout(() => {\r\n        router.back();\r\n      }, 2000);\r\n\r\n    } catch (err) {\r\n      console.error('Signup error:', err);\r\n\r\n      const errorMessage = err.response ? err.response.data.error : err.message;\r\n\r\n      if (errorMessage === 'Email already exists') {\r\n        toast.error('This email is already registered. Please use a different one.')\r\n      } else {\r\n        toast.error(errorMessage)\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const openModal = () => {\r\n    setIsModalOpen(true);\r\n  \r\n    // Initialize OTPless every time the modal opens\r\n    try {\r\n      initOTPless(callback);  // Reinitialize OTPless here\r\n    } catch (error) {\r\n      console.error(\"Error initializing OTPless:\", error);\r\n      toast.error(\"Error initializing OTPless.\");\r\n    }\r\n  };\r\n  \r\n\r\n  const closeModal = () => {\r\n    setIsModalOpen(false);\r\n  };\r\n  const callback = async (otplessUser) => {\r\n    console.log(\"Callback triggered with user data:\", otplessUser);\r\n  \r\n    if (otplessUser) {\r\n      console.log(\"OTPless condition passed\");\r\n\r\n      try {\r\n          const { identities } = otplessUser;\r\n\r\n          if (!identities || identities.length === 0) {\r\n              console.error(\"Identities array is missing or empty:\", identities);\r\n              return;\r\n          }\r\n\r\n          const email = identities[0]?.identityValue;\r\n          const name = identities[0]?.name;\r\n          const picture = identities[0]?.picture;\r\n\r\n          const response = await axios.post(\"/api/Auth\", {\r\n              email,\r\n              picture,\r\n              name,\r\n          });\r\n\r\n          if (response.status === 200) {\r\n              const { token, user } = response.data;\r\n              localStorage.setItem(\"token\", token);\r\n\r\n              if (response.data.error === \"Email already exists\") {\r\n                  console.log(\"Account already exists, skipping success toast.\");\r\n                  return;  \r\n              }\r\n\r\n              toast.success(`Account created successfully, ${name}`);\r\n\r\n              setIsModalOpen(false);\r\n\r\n             \r\n              setTimeout(() => {\r\n                router.back();\r\n              }, 3000);\r\n          }\r\n      } catch (error) {\r\n          toast.error(\"Error during authentication: \" + error.message);\r\n          console.error(\"Error during authentication:\", error);\r\n      }\r\n  } else {\r\n      console.error(\"OTPless login failed or no user data returned\");\r\n  }\r\n  };\r\n  \r\n  \r\n  \r\n\r\n  return (\r\n    <div className=\"login-container\">\r\n      {/* Left Section */}\r\n      <div className=\"left-section\">\r\n        <Image\r\n          src={backgrounds[backgroundIndex]}\r\n          alt=\"Background\"\r\n          layout=\"fill\"\r\n          objectFit=\"cover\"\r\n          objectPosition=\"center\"\r\n          quality={100}\r\n        />\r\n        <div className=\"overlay\">\r\n          <h2>Join Us Today!</h2>\r\n          <p>Create an account to enjoy exclusive benefits and seamless access.</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Right Section */}\r\n      <div className=\"right-section\">\r\n        <div className=\"form-card\">\r\n          <button className=\"back-button\" onClick={() => router.push('/')}>\r\n            Back to website ‚Üí\r\n          </button>\r\n          <h1 className=\"form-header\">Create an account</h1>\r\n          <p className=\"form-subheader\">\r\n            Already have an account?  \r\n            <button\r\n              onClick={() => router.push('/frontend/login')}\r\n              className=\"signup-link\"\r\n              style={{\r\n                background: 'none',\r\n                border: 'none',\r\n                color: '#6f42c1',\r\n                fontWeight: 600,\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              Login\r\n            </button>\r\n          </p>\r\n\r\n          <form className=\"signup-form\" onSubmit={handleSubmit}>\r\n            <div className=\"form-group form-row\">\r\n              <input\r\n                type=\"text\"\r\n                id=\"first-name\"\r\n                name=\"firstName\"\r\n                placeholder=\"First Name\"\r\n                value={formData.firstName}\r\n                onChange={handleChange}\r\n                required\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                id=\"last-name\"\r\n                name=\"lastName\"\r\n                placeholder=\"Last Name\"\r\n                value={formData.lastName}\r\n                onChange={handleChange}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <input\r\n                type=\"email\"\r\n                id=\"email\"\r\n                name=\"email\"\r\n                placeholder=\"Email\"\r\n                value={formData.email}\r\n                onChange={handleChange}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group password-group\">\r\n              <input\r\n                type={showPassword ? 'text' : 'password'}\r\n                id=\"password\"\r\n                name=\"password\"\r\n                placeholder=\"Enter your password\"\r\n                value={formData.password}\r\n                onChange={handleChange}\r\n                required\r\n              />\r\n              <span\r\n                className=\"eye-icon\"\r\n                onClick={() => setShowPassword(!showPassword)}\r\n              >\r\n                {showPassword ? 'üëÅÔ∏è' : 'üôà'}\r\n              </span>\r\n            </div>\r\n\r\n            <button type=\"submit\" className=\"signup-button\" disabled={loading}>\r\n              {loading ? 'Creating account...' : 'Create account'}\r\n            </button>\r\n\r\n            <div className=\"divider\">Or register with</div>\r\n\r\n            <div className=\"social-buttons\">\r\n              <button className=\"google-button\" onClick={openModal}>\r\n                Google\r\n              </button>\r\n              <button className=\"apple-button\">Apple</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal for OTPless Login */}\r\n      <Modal\r\n        isOpen={isModalOpen}\r\n        onRequestClose={closeModal}\r\n        contentLabel=\"OTPless Login\"\r\n        className=\"otpless-modal\"\r\n        overlayClassName=\"otpless-overlay\"\r\n      >\r\n        <div className=\"otpless-container\">\r\n          <div id=\"otpless-login-page\"></div>\r\n        </div>\r\n        <button onClick={closeModal} className=\"close-modal-button\">\r\n          Close\r\n        </button>\r\n      </Modal>\r\n\r\n      <ToastContainer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Signup;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 443, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}